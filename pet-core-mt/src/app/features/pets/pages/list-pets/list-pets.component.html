<div class="container-responsive py-10">
  <div class="mb-6">
    <h1 class="text-3xl font-semibold text-gray-900 mb-6">Pets</h1>

    <div class="mb-6">
      <input
        type="text"
        [value]="searchTerm()"
        (input)="onSearchChange($any($event.target).value)"
        placeholder="Buscar por nome..."
        class="w-full max-w-md px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-500/30 focus:border-brand-500"
      />
    </div>

    @if (error$ | async; as error) {
      <div class="mb-4 p-4 bg-red-50 border border-red-200 rounded-xl text-red-700">
        {{ error }}
      </div>
    }
  </div>

  @if (loading$ | async) {
    <div class="text-center py-12">
      <p class="text-gray-600">Carregando pets...</p>
    </div>
  } @else {
    @if (pets$ | async; as pets) {
      @if (pets.length === 0) {
        <div class="text-center py-12">
          <p class="text-gray-600">Nenhum pet encontrado.</p>
        </div>
      } @else {
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8">
          @for (pet of pets; track pet.id) {
            <div
              class="card p-4 hover:shadow-float transition-shadow"
            >
              @if (pet.foto?.url) {
                <img
                  [src]="pet.foto?.url"
                  [alt]="pet.nome"
                  class="w-full h-48 object-cover rounded-xl mb-4"
                />
              } @else {
                <div class="w-full h-48 bg-gray-200 rounded-xl mb-4 flex items-center justify-center">
                  <span class="text-gray-400">Sem foto</span>
                </div>
              }

              <h3 class="text-lg font-semibold text-gray-900 mb-2">{{ pet.nome }}</h3>

              <div class="space-y-1 text-sm text-gray-600">
                <p><span class="font-medium">Raça:</span> {{ pet.raca }}</p>
                @if (pet.idade !== undefined && pet.idade !== null) {
                  <p><span class="font-medium">Idade:</span> {{ pet.idade }} {{ pet.idade === 1 ? 'ano' : 'anos' }}</p>
                }
              </div>
            </div>
          }
        </div>

        @if (totalPages$ | async; as totalPages) {
          @if (currentPage$ | async; as currentPage) {
            @if (totalElements$ | async; as total) {
              @if (totalPages > 1) {
                <div class="flex items-center justify-center gap-2">
                  <button
                    type="button"
                    [disabled]="currentPage === 0"
                    (click)="onPageChange(currentPage - 1)"
                    class="btn btn-ghost"
                  >
                    Anterior
                  </button>

                  <span class="text-sm text-gray-600">
                    Página {{ currentPage + 1 }} de {{ totalPages }}
                    <span class="text-gray-400">({{ total }} {{ total === 1 ? 'pet' : 'pets' }})</span>
                  </span>

                  <button
                    type="button"
                    [disabled]="currentPage >= totalPages - 1"
                    (click)="onPageChange(currentPage + 1)"
                    class="btn btn-ghost"
                  >
                    Próxima
                  </button>
                </div>
              }
            }
          }
        }
      }
    }
  }
</div>
